.\" -*- mode: nroff -*-
.\" Generated by 'click-elem2man' from '../elements/ip/storeipaddress.hh:7'
.de M
.IR "\\$1" "(\\$2)\\$3"
..
.de RM
.RI "\\$1" "\\$2" "(\\$3)\\$4"
..
.TH "STOREIPADDRESS" 7click "12/Oct/2017" "Click"
.SH "NAME"
StoreIPAddress \- Click element;
stores IP address in packet
.SH "SYNOPSIS"
\fBStoreIPAddress\fR(OFFSET)
.br
\fBStoreIPAddress\fR(ADDR, OFFSET)

\fBPorts\fR: 1 input, 1-2 outputs
.br
\fBProcessing\fR: agnostic, but output 1 is push
.br
.SH "DESCRIPTION"
The one-argument form writes the destination IP address annotation into the
packet at offset OFFSET, usually an integer. But if the annotation is zero, it
doesn't change the packet.
.PP
The two-argument form writes IP address ADDR into the packet at offset
OFFSET. ADDR can be zero.
.PP
The OFFSET argument may be the special string 'src' or 'dst'.  In this case,
incoming packets must be IP packets.  \fBStoreIPAddress\fR writes the address into
either the source or destination field of the IP packet header, as specified,
and incrementally updates the IP checksum (and, if appropriate, the TCP/UDP
checksum) to account for the change.
.PP
If OFFSET is out of range, the packet is dropped or emitted on optional output
1.
.PP

.SH "NOTES"
Unless you use a special OFFSET of 'src' or 'dst', this element doesn't
recalculate any checksums.  If you store the address into an existing IP
packet, the packet's checksum will need to be set -- for example, with
.M SetIPChecksum 7 .
And don't forget that you might need to recalculate TCP and UDP
checksums as well. Here's a useful compound element:
.PP
.nf
\&  elementclass FixIPChecksums {
\&      // fix the IP checksum, and any embedded checksums that
\&      // include data from the IP header (TCP and UDP in particular)
\&      input -> SetIPChecksum
\&          -> ipc :: IPClassifier(tcp, udp, -)
\&          -> SetTCPChecksum
\&          -> output;
\&      ipc[1] -> SetUDPChecksum -> output;
\&      ipc[2] -> output
\&  }
.fi
.PP



.SH "SEE ALSO"
.M SetIPChecksum 7 ,
.M SetTCPChecksum 7 ,
.M SetUDPChecksum 7 ,
.M IPAddrPairRewriter 7 ,
.M IPAddrRewriter 7


.\" -*- mode: nroff -*-
.\" Generated by 'click-elem2man' from '../elements/analysis/fromtcpdump.hh:14'
.de M
.IR "\\$1" "(\\$2)\\$3"
..
.de RM
.RI "\\$1" "\\$2" "(\\$3)\\$4"
..
.TH "FROMTCPDUMP" 7click "12/Oct/2017" "Click"
.SH "NAME"
FromTcpdump \- Click element;
reads packets from an ASCII tcpdump output file
.SH "SYNOPSIS"
\fBFromTcpdump\fR(FILENAME [, \fIKEYWORDS\fR])

\fBPorts\fR: no inputs, 1 output
.br
\fBProcessing\fR: agnostic
.br
\fBDrivers\fR: userlevel
.br
.SH "DESCRIPTION"
Reads textual TCP/IP packet descriptors from an ASCII 
.M tcpdump 1
output file,
then creates packets resembling those descriptors and pushes them out the
output. Optionally stops the driver when there are no more packets.
.PP
The file may be compressed with gzip(1) or bzip2(1); \fBFromTcpdump\fR will
run zcat(1) or bzcat(1) to uncompress it.
.PP
\fBFromTcpdump\fR reads from the file named FILENAME unless FILENAME is a
single dash `\f(CW-\fR', in which case it reads from the standard input. It will
not uncompress the standard input, however.
.PP
\fBFromTcpdump\fR doesn't parse many of the relevant parts of the file. It handles
fragments badly, for example. Mostly it just does TCP and some rudimentary
UDP.
.PP
Keyword arguments are:
.PP


.IP "STOP" 8
Boolean. If true, then \fBFromTcpdump\fR will ask the router to stop when it
is done reading. Default is false.
.IP "" 8
.IP "ACTIVE" 8
Boolean. If false, then \fBFromTcpdump\fR will not emit packets (until the
`\f(CWactive\fR' handler is written). Default is true.
.IP "" 8
.IP "ZERO" 8
Boolean. Determines the contents of packet data not set by the dump. If true
(the default), this data is zero. If false, it is random garbage.
.IP "" 8
.IP "CHECKSUM" 8
Boolean. If true, then output packets' IP, TCP, and UDP checksums are set. If
false (the default), the checksum fields contain random garbage.
.IP "" 8
.IP "SAMPLE" 8
Unsigned real number between 0 and 1. \fBFromTcpdump\fR will output each
packet with probability SAMPLE. Default is 1. \fBFromTcpdump\fR uses
fixed-point arithmetic, so the actual sampling probability may differ
substantially from the requested sampling probability. Use the
\f(CWsampling_prob\fR handler to find out the actual probability. If MULTIPACKET is
true, then the sampling probability applies separately to the multiple packets
generated per record.
.IP "" 8
.PP
Only available in user-level processes.
.PP
.SH "NOTES"
\fBFromTcpdump\fR is a notifier signal, active when the element is active and
the dump contains more packets.
.PP
.M tcpdump 1 's
binary output is generally much better than the output of
\fBFromTcpdump\fR. Unfortunately, some people just throw it away.
.PP

.SH "ELEMENT HANDLERS"



.IP "\fBsampling_prob\fR (read-only)" 5
Returns the sampling probability (see the SAMPLE keyword argument).
.IP "" 5
.IP "\fBactive\fR (read/write)" 5
Value is a Boolean.
.IP "" 5
.IP "\fBencap\fR (read-only)" 5
Returns `IP'. Useful for ToDump's USE_ENCAP_FROM option.
.IP "" 5
.IP "\fBfilesize\fR (read-only)" 5
Returns the length of the \fBFromTcpdump\fR file, in bytes, or "-" if that
length cannot be determined.
.IP "" 5
.IP "\fBfilepos\fR (read-only)" 5
Returns \fBFromTcpdump\fR's position in the file, in bytes.
.IP "" 5
.IP "\fBstop\fR (write-only)" 5
When written, sets `active' to false and stops the driver.
.IP "" 5
.PP

.SH "SEE ALSO"
.M tcpdump 1 ,
.M FromDump 7 ,
.M FromIPSummaryDump 7


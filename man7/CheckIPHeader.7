.\" -*- mode: nroff -*-
.\" Generated by 'click-elem2man' from '../elements/ip/checkipheader.hh:8'
.de M
.IR "\\$1" "(\\$2)\\$3"
..
.de RM
.RI "\\$1" "\\$2" "(\\$3)\\$4"
..
.TH "CHECKIPHEADER" 7click "12/Oct/2017" "Click"
.SH "NAME"
CheckIPHeader \- Click element;
checks IP header
.SH "SYNOPSIS"
\fBCheckIPHeader\fR([OFFSET, \fIkeywords\fR OFFSET, INTERFACES, BADSRC,
.br
.nf
\&                       GOODDST, CHECKSUM, VERBOSE, DETAILS])
.fi
.PP



\fBPorts\fR: 1 input, 1-2 outputs
.br
\fBProcessing\fR: agnostic, but output 1 is push
.br
.SH "DESCRIPTION"
Input packets should have IP headers starting OFFSET bytes in. Default OFFSET
is zero. Checks that the packet's length is reasonable, and that the IP
version, header length, length, and checksum fields are valid. Checks that the
IP source address is a legal unicast address, or that the packet is destined
for one of this machine's addresses (see below). Shortens packets to the IP
length, if the IP length is shorter than the nominal packet length (due to
Ethernet padding, for example). Also sets the destination IP address
annotation to the actual destination IP address.
.PP
\fBCheckIPHeader\fR emits valid packets on output 0. Invalid packets are pushed out
on output 1, unless output 1 was unused; if so, drops invalid packets.
.PP
\fBCheckIPHeader\fR checks packets' source addresses for validity if one or more of
the INTERFACES, BADSRC, and GOODDST keyword arguments are supplied (RFC1812
5.3.7).
.PP
\fBCheckIPHeader\fR prints a message to the console the first time it encounters an
incorrect IP packet (but see VERBOSE below).
.PP
Keyword arguments are:
.PP


.IP "CHECKSUM" 5
Boolean. If true, then check each packet's checksum for validity; if false, do
not check the checksum. Default is true.
.IP "" 5
.IP "OFFSET" 5
Unsigned integer. Byte position at which the IP header begins. Default is 0.
.IP "" 5
.IP "BADSRC" 5
Space-separated list of IP addresses. \fBCheckIPHeader\fR will drop packets whose
source address is on this list (but see GOODDST below). Default is empty.
.IP "" 5
.IP "GOODDST" 5
Space-separated list of IP addresses. \fBCheckIPHeader\fR exempts packets whose
destination address is on this list from BADSRC processing. Default is empty.
.IP "" 5
.IP "INTERFACES" 5
Space-separated list of IP addresses with network prefixes, meant to represent
this router's interface addresses. This argument specifies both BADSRC and
GOODDST. Specifically, the argument "INTERFACES 18.26.4.9/24 18.32.9.44/28"
acts like a BADSRC of "18.26.4.255 18.32.9.47 0.0.0.0 255.255.255.255" -- the
set of broadcast addresses for this router -- and a GOODDST of "18.26.4.9
18.32.9.44". Default is not given.
.IP "" 5
.IP "VERBOSE" 5
Boolean. If it is true, then a message will be printed for every erroneous
packet, rather than just the first. False by default.
.IP "" 5
.IP "DETAILS" 5
Boolean. If it is true, then \fBCheckIPHeader\fR will maintain detailed counts of
how many packets were dropped for each possible reason, accessible through the
\f(CWdrop_details\fR handler. False by default.
.IP "" 5
.PP

.SH "NOTES"
\fBCheckIPHeader\fR supports an old configuration syntax:
.PP
\fBCheckIPHeader\fR([BADSRC2, OFFSET, \fIkeywords\fR])
.PP
The BADSRC2 argument behaves like the BADSRC keyword, except that if you use
this syntax, 0.0.0.0 and 255.255.255.255 considered bad addresses in addition
to those explicitly in the list. This syntax is deprecated and should not be
used in new configurations.
.PP

.SH "ELEMENT HANDLERS"



.IP "\fBdrops\fR (read-only)" 5
Returns the number of incorrect packets \fBCheckIPHeader\fR has seen.
.IP "" 5
.IP "\fBdrop_details\fR (read-only)" 5
Returns a text file showing how many erroneous packets \fBCheckIPHeader\fR has seen,
subdivided by error. Only available if the DETAILS keyword argument was true.
.IP "" 5
.PP

.SH "SEE ALSO"
.M CheckIPHeader2 7 ,
.M MarkIPHeader 7 ,
.M SetIPChecksum 7 ,
.M StripIPHeader 7 ,
.M CheckTCPHeader 7 ,
.M CheckUDPHeader 7 ,
.M CheckICMPHeader 7


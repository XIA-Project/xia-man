.\" -*- mode: nroff -*-
.\" Generated by 'click-elem2man' from '../elements/ip/ipratemon.hh:11'
.de M
.IR "\\$1" "(\\$2)\\$3"
..
.de RM
.RI "\\$1" "\\$2" "(\\$3)\\$4"
..
.TH "IPRATEMONITOR" 7click "12/Oct/2017" "Click"
.SH "NAME"
IPRateMonitor \- Click element;
measures coming and going IP traffic rates
.SH "SYNOPSIS"
\fBIPRateMonitor\fR(TYPE, RATIO, THRESH [, MEMORY, ANNO])

\fBPorts\fR: 1-2 inputs, 1-2 outputs
.br
\fBProcessing\fR: agnostic
.br
\fBDrivers\fR: userlevel
.br
.SH "DESCRIPTION"
Monitors network traffic rates. Can monitor either packet or byte rate (per
second) to and from an address. When forward or reverse rate for a
particular address exceeds THRESH, rates will then be kept for host or
subnet addresses within that address. May update each packet's
dst_rate_anno and src_rate_anno with the rates for dst or src IP address.
.PP
Packets coming in one input 0 are inspected on src address. Packets coming
in on input 1 are insepected on dst address. This enables \fBIPRateMonitor\fR to
annotate packets with both the forward rate and reverse rate.
.PP
TYPE: PACKETS or BYTES. Count number of packets or bytes.
.PP
RATIO: chance that EWMA gets updated before packet is annotated with EWMA
value.
.PP
THRESH: \fBIPRateMonitor\fR further splits a subnet if rate is over THRESH number
packets or bytes per second. Always specify value as if RATIO were 1.
.PP
MEMORY: How much memory can \fBIPRateMonitor\fR use in kilobytes? Minimum of 100
is enforced. 0 is unlimited memory.
.PP
ANNO: if on (by default, it is), annotate packets with rates.
.PP

.SH "ELEMENT HANDLERS"



.IP "\fBlook\fR ((read))" 5
Returns the rate of counted to and from a cluster of IP addresses. The first
printed line is the number of 'jiffies' that have past since the last reset.
There are 100 jiffies in one second.
.IP "" 5
.IP "\fBthresh\fR ((read))" 5
Returns THRESH.
.IP "" 5
.IP "\fBreset\fR ((write))" 5
When written, resets all rates.
.IP "" 5
.IP "\fBanno_level\fR ((write))" 5
Expects "IPAddress level when". When written, makes \fBIPRateMonitor\fR stop
expanding at "level" (0-3) for the IPAddress, until "when" (seconds).  For
example, if "18.26.4.0 2 100" is specified, \fBIPRateMonitor\fR will stop
expanding when 18.26.4 is reached for the next 100 seconds. After 100
seconds, any level below 18.26.4 may be reached again.
.IP "" 5
.PP

.SH "EXAMPLES"

.nf
\& IPRateMonitor(PACKETS, 0.5, 256, 600);
.fi
.PP
Monitors packet rates. The memory usage is limited to 600K. When rate for a
network address (e.g. 18.26.*.*) exceeds 256 packets per second, start
monitor subnet or host addresses (e.g. 18.26.4.*).
.PP


.SH "SEE ALSO"
.M IPFlexMonitor 7 ,
.M CompareBlock 7


.\" -*- mode: nroff -*-
.\" Generated by 'click-elem2man' from '../elements/icmp/icmppingrewriter.hh:8'
.de M
.IR "\\$1" "(\\$2)\\$3"
..
.de RM
.RI "\\$1" "\\$2" "(\\$3)\\$4"
..
.TH "ICMPPINGREWRITER" 7click "12/Oct/2017" "Click"
.SH "NAME"
ICMPPingRewriter \- Click element;
rewrites ICMP echo requests and replies
.SH "SYNOPSIS"
\fBICMPPingRewriter\fR(INPUTSPEC1, ..., INPUTSPECn, \fIkeywords\fR DST_ANNO, TIMEOUT)

.SH "DESCRIPTION"
Rewrites ICMP echo requests and replies by changing their source and/or
destination addresses and ICMP identifiers.  This lets pings pass through a
NAT gateway.
.PP
Expects ICMP echo requests and echo replies.  Each ICMP echo request is
rewritten according to the INPUTSPEC on its input port.  The INPUTSPEC may
change the packets' addresses.  Usually the INPUTSPEC will also specify a
source port range, which is used to change echo requests' identifiers.
Replies to the rewritten request are also rewritten to look like they were
responding to the original request.  \fBICMPPingRewriter\fR optionally changes
destination IP address annotations; see the DST_ANNO keyword argument below.
.PP
\fBICMPPingRewriter\fR actually keeps a table of mappings. Each mapping changes
a given (source address, destination address, identifier) triple into another
triple. Say that \fBICMPPingRewriter\fR receives a request packet with triple
(\fIsrc\fR, \fIdst\fR, \fIident\fR), and chooses for it a new triple, (\fIsrc2\fR,
\fIdst2\fR, \fIident2\fR). The rewriter will then store two mappings in the table.
The first mapping changes requests (\fIsrc\fR, \fIdst\fR, \fIident\fR) into
requests (\fIsrc2\fR, \fIdst2\fR, \fIident2\fR). The second mapping changes
\fIreplies\fR (\fIdst2\fR, \fIsrc2\fR, \fIident2\fR) into replies (\fIdst\fR, \fIsrc\fR,
\fIident\fR).  Mappings are removed if they go unused for a default of 5 minutes.
.PP
Unexpected echo replies are dropped unless they arrive on an input with 'pass'
INPUTSPEC.
.PP
Keyword arguments are:
.PP
Keyword arguments are:
.PP


.IP "TIMEOUT \fItime\fR" 5
Time out connections every \fItime\fR seconds. Default is 5 minutes.
.IP "" 5
.IP "GUARANTEE \fItime\fR" 5
Preserve each connection mapping for at least \fItime\fR seconds after each
successfully processed packet. Defaults to 5 seconds. Incoming flows are
dropped if the mapping table is full of guaranteed flows.
.IP "" 5
.IP "REAP_INTERVAL \fItime\fR" 5
Reap timed-out connections every \fItime\fR seconds. Default is 15 minutes.
.IP "" 5
.IP "MAPPING_CAPACITY \fIcapacity\fR" 5
Set the maximum number of mappings this rewriter can hold to \fIcapacity\fR.
\fICapacity\fR can either be an integer or the name of another rewriter-like
element, in which case this element will share the other element's capacity.
.IP "" 5
.IP "DST_ANNO" 5
Boolean. If true, then set the destination IP address annotation on passing
packets to the rewritten destination address. Default is true.
.IP "" 5
.PP

.SH "SEE ALSO"
.M IPRewriter 7 ,
.M ICMPPingResponder 7


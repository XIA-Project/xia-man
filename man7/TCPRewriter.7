.\" -*- mode: nroff -*-
.\" Generated by 'click-elem2man' from '../elements/tcpudp/tcprewriter.hh:8'
.de M
.IR "\\$1" "(\\$2)\\$3"
..
.de RM
.RI "\\$1" "\\$2" "(\\$3)\\$4"
..
.TH "TCPREWRITER" 7click "12/Oct/2017" "Click"
.SH "NAME"
TCPRewriter \- Click element;
rewrites TCP packets' addresses, ports, and sequence numbers
.SH "SYNOPSIS"
\fBTCPRewriter\fR(INPUTSPEC1, ..., INPUTSPECn [, KEYWORDS])

.SH "DESCRIPTION"
Rewrites TCP flows by changing their source address, source port, destination
address, and/or destination port, and optionally, their sequence numbers and
acknowledgement numbers. It also changes the destination IP address
annotation; see the DST_ANNO keyword argument below.
.PP
This element is an 
.M IPRewriter 7 -like
element. Please read the 
.M IPRewriter 7
documentation for more information and a detailed description of its
INPUTSPEC arguments.
.PP
In addition to 
.M IPRewriter 7 's
functionality, the \fBTCPRewriter\fR element can add or
subtract amounts from incoming packets' sequence and acknowledgement numbers,
including any SACK acknowledgement numbers. Each newly created mapping starts
with these deltas at zero; other elements can request changes to a given
mapping. For example, 
.M FTPPortMapper 7
uses this facility.
.PP
Keyword arguments determine how often stale mappings should be removed.
.PP


.IP "TCP_TIMEOUT \fItime\fR" 5
Time out TCP connections every \fItime\fR seconds. Default is 24 hours. This
timeout applies to TCP connections for which payload data has been seen
flowing in both directions.
.IP "" 5
.IP "TCP_DONE_TIMEOUT \fItime\fR" 5
Time out completed TCP connections every \fItime\fR seconds. Default is 4
minutes. FIN and RST flags mark TCP connections as complete.
.IP "" 5
.IP "TCP_NODATA_TIMEOUT \fItime\fR" 5
Time out non-bidirectional TCP connections every \fItime\fR seconds. Default is 5
minutes. A non-bidirectional TCP connection is one in which payload data
hasn't been seen in at least one direction.
.IP "" 5
.IP "TCP_GUARANTEE \fItime\fR" 5
Preserve each TCP connection mapping for at least \fItime\fR seconds after each
successfully processed packet. Defaults to 5 seconds. Incoming flows are
dropped if an \fBTCPRewriter\fR's mapping table is full of guaranteed flows.
.IP "" 5
.IP "REAP_INTERVAL \fItime\fR" 5
Reap timed-out connections every \fItime\fR seconds. Default is 15 minutes.
.IP "" 5
.IP "MAPPING_CAPACITY \fIcapacity\fR" 5
Set the maximum number of mappings this rewriter can hold to \fIcapacity\fR.
\fICapacity\fR can either be an integer or the name of another rewriter-like
element, in which case this element will share the other element's capacity.
.IP "" 5
.IP "DST_ANNO" 5
Boolean. If true, then set the destination IP address annotation on passing
packets to the rewritten destination address. Default is true.
.IP "" 5
.PP

.SH "ELEMENT HANDLERS"



.IP "\fBtable\fR (read-only)" 5
Returns a human-readable description of the \fBTCPRewriter\fR's current mapping
table.
.IP "" 5
.IP "\fBlookup\fR (read)" 5
Takes a flow as a space-separated
.IP "" 5
.nf
\&    saddr sport daddr dport
.fi
.IP "" 5
and attempts to find a forward mapping for that flow. If found, rewrites the
flow and returns in the same format.  Otherwise, returns nothing.
.IP "" 5

.PP

.SH "SEE ALSO"
.M IPRewriter 7 ,
.M IPAddrRewriter 7 ,
.M IPAddrPairRewriter 7 ,
.M IPRewriterPatterns 7 ,
.M FTPPortMapper 7


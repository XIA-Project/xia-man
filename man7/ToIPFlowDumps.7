.\" -*- mode: nroff -*-
.\" Generated by 'click-elem2man' from '../elements/analysis/toipflowdumps.hh:14'
.de M
.IR "\\$1" "(\\$2)\\$3"
..
.de RM
.RI "\\$1" "\\$2" "(\\$3)\\$4"
..
.TH "TOIPFLOWDUMPS" 7click "12/Oct/2017" "Click"
.SH "NAME"
ToIPFlowDumps \- Click element;
creates separate trace files for each TCP/UDP flow
.SH "SYNOPSIS"
\fBToIPFlowDumps\fR(FILEPATTERN [, \fIKEYWORDS\fR])

\fBPorts\fR: 1 input, at most 1 output
.br
\fBProcessing\fR: agnostic
.br
\fBDrivers\fR: userlevel
.br
.SH "DESCRIPTION"
Writes summary information about incoming packets, in the style of
.M ToIPSummaryDump 7 ,
to several files, one file per flow. It distinguishes flows
by their aggregate annotations. You usually will run \fBToIPFlowDumps\fR downstream
of an 
.M AggregateIPFlows 7
element.
.PP
The FILEPATTERN argument gives the pattern used by 
.M ToIPSummaryDump 7
to
generate filenames. Printf-like `\f(CW%\fR' escapes in the pattern are expanded
differently for each flow. Available escapes are:
.PP
.nf
\&    %n      Aggregate annotation in decimal.
\&    %.0n    Upper 8 bits of aggregate annotation in decimal.
\&    %.1n, %.2n, %.3n   Similar for bits 16-23, 8-15, 0-7.
\&    %.4n    Upper 16 bits of aggregate annotation in decimal.
\&    %.5n    Lower 16 bits of aggregate annotation in decimal.
\&    %x, %X  Aggregate annotation in hex.
\&    %.0x, %.1x, ..., %.5x, %.0X, %.1X, ..., %.5X
\&            Like %.0n, ..., %.5n in hex.
\&    %s      Source IP address.
\&    %.0s, %.1s, %.2s, %.3s
\&            First through fourth bytes of source IP address.
\&    %d      Destination IP address.
\&    %.0d, %.1d, %.2d, %.3d
\&            First through fourth bytes of destination IP address.
\&    %S      Source port.
\&    %D      Destination port.
\&    %p      Protocol ('T' for TCP, 'U' for UDP).
\&    %%      A single % sign.
.fi
.PP
You may also use the `\f(CW0\fR' flag and an optional field width, so `\f(CW%06n\fR'
expands to the aggregate annotation, padded on the left with enough zeroes to
make at least 6 digits.
.PP
Keyword arguments are:
.PP



.IP "NOTIFIER" 8
The name of an AggregateNotifier element, like 
.M AggregateIPFlows 7 .
If given,
then \fBToIPFlowDumps\fR will ask the element for notification when flows are
deleted. It uses that notification to free its state early. It's a very good
idea to supply a NOTIFIER.
.IP "" 8
.IP "ABSOLUTE_TIME" 8
Boolean. If true, print absolute timestamps instead of relative timestamps.
Defaults to false.
.IP "" 8
.IP "ABSOLUTE_SEQ" 8
Boolean. If true, print absolute sequence numbers instead of relative
ones. Defaults to false.
.IP "" 8
.IP "BINARY" 8
Boolean. If true, then output binary records instead of ASCII lines. Defaults
to false.
.IP "" 8
.IP "GZIP" 8
Boolean. If true, then run \f(CWgzip\fR to compress completed trace files. (The
resulting files have \fI.gz\fR appended to their FILEPATTERN names.) Defaults
to false.
.IP "" 8
.IP "ALL_TCP_OPT" 8
Boolean. If true, then output any non-padding TCP options present on TCP
packets. Defaults to false.
.IP "" 8
.IP "TCP_OPT" 8
Boolean. If true, then output any MSS, window scaling, and SACK options
present on TCP packets. Defaults to false.
.IP "" 8
.IP "TCP_WINDOW" 8
Boolean. If true, then output each TCP packet's window field. Defaults to
false.
.IP "" 8
.IP "IP_ID" 8
Boolean. If true, then output packets' IP IDs. Defaults to false.
.IP "" 8
.IP "MINCOUNT" 8
Unsigned. Generate output only for flows with at least MINCOUNT packets.
Defaults to 0 (output all flows).
.IP "" 8
.PP

.SH "NOTES"
Only available in user-level processes.
.PP

.SH "EXAMPLES"
This element
.PP
.nf
\&  ... -> ToIPFlowDumps(/tmp/flow%03n);
.fi
.PP
might create a file \f(CW/tmp/flow001\fR with the following contents.
.PP
.nf
\&  !IPSummaryDump 1.1
\&  !data timestamp direction tcp_flags tcp_seq payload_len tcp_ack
\&  !flowid 192.150.187.37 3153 18.26.4.44 21 T
\&  !first_seq > 2195313811
\&  !first_seq < 2484225252
\&  !first_time 1018330170.887165
\&  0.000001 > S 0 0 0
\&  0.075539 < SA 0 0 1
.fi
.PP
Note that sequence numbers have been offset, so that the first sequence
numbers seen by \fBToIPFlowDumps\fR are output as 0. The `\f(CW!first_seq\fR' comments
let you reconstruct actual sequence numbers if necessary. Similarly, timestamp
annotations are relative to `\f(CW!first_time\fR'.
.PP


.SH "SEE ALSO"
.M FromIPSummaryDump 7 ,
.M ToIPSummaryDump 7 ,
.M AggregateIPFlows 7


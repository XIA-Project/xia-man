.\" -*- mode: nroff -*-
.\" Generated by 'click-elem2man' from '../elements/local/reframe.hh:6'
.de M
.IR "\\$1" "(\\$2)\\$3"
..
.de RM
.RI "\\$1" "\\$2" "(\\$3)\\$4"
..
.TH "REFRAME" 7click "12/Oct/2017" "Click"
.SH "NAME"
Reframe \- Click element;
reframes a fragmented stream of packets
.SH "SYNOPSIS"
\fBReframe\fR([\fIkeywords\fR FOFF, FLEN, NTOH, MUL, ALIGN, ADD])

\fBPorts\fR: 1 input, 1 output
.br
\fBDrivers\fR: userlevel
.br
.SH "DESCRIPTION"
Queues incoming packet fragments until a full Ethernet, IP, or
fixed-size frame can be built, then emits it. Does not set packet
annotations. Useful for reframing a fragmented stream of packets
emitted by a userlevel element like 
.M Socket 7 .
Assumes that the stream is
either continuous, or that frames are separated by aligned and/or
fixed-size padding.
.PP
The length of each frame should be encoded in a FLEN (1, 2, or 4) byte
field located FOFF bytes into each frame. The encoded length is
assumed to include FOFF plus FLEN. If the field is encoded in network
order, specify the keyword NTOH. Specify the byte multiplier that
should be used in the keyword MUL, the alignment within the byte
stream (if any) of each frame in the keyword ALIGN, and any additional
bytes that should be added to the result in the keyword ADD.
.PP
If FLEN is 0, all keywords except ADD are ignored and the length of
each frame is assumed to be fixed at ADD bytes.
.PP
For example, to reframe a fragment stream of IP packets (total length
in bytes is encoded 2 bytes into the frame as a 2-byte variable in
network order):
.PP
.nf
\&  ... -> Reframe(FOFF 2, FLEN 2, NTOH 1, MUL 1, ALIGN 1, ADD 0) -> ...
.fi
.PP
Or since these are the keyword defaults:
.PP
.nf
\&  ... -> Reframe -> ...
.fi
.PP
To reframe a fragment stream of IP-in-Ethernet packets:
.PP
.nf
\&  ... -> Reframe(FOFF 16, FLEN 2, ADD 14) -> ...
.fi
.PP
To reframe a fragment stream of fixed-size 100 byte packets:
.PP
.nf
\&  ... -> Reframe(FLEN 0, ADD 100) -> ...
.fi
.PP
Keyword arguments are:
.PP



.IP "FOFF" 8
Integer. Specifies the byte offset of the encoded length field in each
frame in the fragment stream. Default is 2 (IP).
.IP "" 8
.IP "FLEN" 8
Integer. Specifies the length of the encoded length field in each
frame in the fragment stream. Default is 2 (IP).
.IP "" 8
.IP "NTOH" 8
Boolean. When true, \fBReframe\fR will assume that the length field is
encoded in network order in each frame in the fragment stream. Default
is true (IP).
.IP "" 8
.IP "MUL" 8
Integer. Specifies the number of bytes per unit of encoded
length. Default is 1 (IP).
.IP "" 8
.IP "ALIGN" 8
Integer. Specifies the byte alignment of each frame in the fragment
stream. For example, a byte alignment of 4 would ensure that each
frame began and ended at a byte offset (from the start of the stream)
that was divisible by 4. Default is 1 (IP).
.IP "" 8
.IP "ADD" 8
Integer. Specifies the number of additional bytes that should be added
to each frame in the fragment stream. Default is 0 (IP).
.IP "" 8
.PP

.SH "EXAMPLES"
// \fBReframe\fR a fragmented stream of tunnelled IP frames
.M Socket 7 (TCP,
0.0.0.0, 12345) -> \fBReframe\fR -> ...
.PP
// \fBReframe\fR a fragmented stream of tunnelled IP-in-GRE frames. Plain
// GRE headers are 4 bytes long and do not include a payload length
// field, so we must reach 4 + 2 = 6 bytes into each frame to reach
// the IP length field, and add 4 bytes to account for the GRE header.
.M Socket 7 (TCP,
0.0.0.0, 12345) -> \fBReframe\fR(FOFF 6, ADD 4) -> StripGREHeader ...
.PP
// A useless 1000 byte latency bucket
\&... -> \fBReframe\fR(FLEN 0, ADD 1000) -> ...
.PP

.SH "SEE ALSO"
.M Socket 7


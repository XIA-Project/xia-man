.\" -*- mode: nroff -*-
.\" Generated by 'click-elem2man' from '../elements/userlevel/fromdump.hh:12'
.de M
.IR "\\$1" "(\\$2)\\$3"
..
.de RM
.RI "\\$1" "\\$2" "(\\$3)\\$4"
..
.TH "FROMDUMP" 7click "12/Oct/2017" "Click"
.SH "NAME"
FromDump \- Click element;
reads packets from a tcpdump file
.SH "SYNOPSIS"
\fBFromDump\fR(FILENAME [, \fIkeywords\fR STOP, TIMING, SAMPLE, FORCE_IP, START, START_AFTER, END, END_AFTER, INTERVAL, END_CALL, FILEPOS, MMAP])

\fBPorts\fR: no inputs, 1-2 outputs
.br
\fBProcessing\fR: agnostic, but output 1 is push
.br
\fBDrivers\fR: userlevel, ns
.br
.SH "DESCRIPTION"
Reads packets from a file produced by `tcpdump -w FILENAME' or 
.M ToDump 7
and
emits them from the output, optionally stopping the driver when there are no
more packets.
.PP
\fBFromDump\fR also transparently reads gzip- and bzip2-compressed tcpdump files, if
you have zcat(1) and bzcat(1) installed.
.PP
Keyword arguments are:
.PP


.IP "STOP" 8
Boolean.  If true, then \fBFromDump\fR will ask the router to stop when it is done
reading its tcpdump file (or the END time is reached).  Default is false.
.IP "" 8
.IP "TIMING" 8
Boolean. If true, then \fBFromDump\fR tries to maintain the timing of the original
packet stream. The first packet is emitted immediately; thereafter, \fBFromDump\fR
maintains the delays between packets. Default is false.
.IP "" 8
.IP "SAMPLE" 8
Unsigned real number between 0 and 1. \fBFromDump\fR will output each packet with
probability SAMPLE. Default is 1. \fBFromDump\fR uses fixed-point arithmetic, so the
actual sampling probability may differ substantially from the requested
sampling probability. Use the \f(CWsampling_prob\fR handler to find out the actual
probability.
.IP "" 8
.IP "FORCE_IP" 8
Boolean. If true, then \fBFromDump\fR will emit only IP packets with their IP header
annotations correctly set. (If \fBFromDump\fR has two outputs, non-IP packets are
pushed out on output 1; otherwise, they are dropped.) Default is false.
.IP "" 8
.IP "START" 8
Absolute time in seconds since the epoch. \fBFromDump\fR will output packets with
timestamps after that time.
.IP "" 8
.IP "START_AFTER" 8
Argument is relative time in seconds (or supply a suffix like `min', `h').
\fBFromDump\fR will skip the first \fIT\fR seconds in the log.
.IP "" 8
.IP "END" 8
Absolute time in seconds since the epoch. \fBFromDump\fR will stop when encountering
a packet with timestamp at or after that time.
.IP "" 8
.IP "END_AFTER" 8
Argument is relative time in seconds (or supply a suffix like `min', `h').
\fBFromDump\fR will stop at the first packet whose timestamp is at least \fIT\fR
seconds after the first timestamp in the log.
.IP "" 8
.IP "INTERVAL" 8
Argument is relative time in seconds (or supply a suffix like `min', `h').
\fBFromDump\fR will stop at the first packet whose timestamp is at least \fIT\fR
seconds after the first packet output.
.IP "" 8
.IP "END_CALL" 8
Specify a handler to call once the end time is reached, or the dump runs out
of packets.  This defaults to '\fIFromDump\fR.active false'.  END_CALL and STOP
are mutually exclusive.
.IP "" 8
.IP "ACTIVE" 8
Boolean. If false, then \fBFromDump\fR will not emit packets (until the `\f(CWactive\fR'
handler is written). Default is true.
.IP "" 8
.IP "FILEPOS" 8
File offset. If supplied, then \fBFromDump\fR will start emitting packets from
this (uncompressed) file position. This is dangerous; there's no cheap way
to check whether you got the offset wrong, and if you did get it wrong,
\fBFromDump\fR will emit garbage.
.IP "" 8
.IP "MMAP" 8
Boolean. If true, then \fBFromDump\fR will use 
.M mmap 2
to access the tcpdump file.
This can result in slightly better performance on some machines. \fBFromDump\fR's
regular file discipline is pretty optimized, so the difference is often small
in practice. Default is true on most operating systems, but false on Linux.
.IP "" 8
.PP
You can supply at most one of START and START_AFTER, and at most one of END,
END_AFTER, and INTERVAL.
.PP
Only available in user-level processes.
.PP
.SH "NOTES"
By default, `tcpdump -w FILENAME' dumps only the first 68 bytes of
each packet. You probably want to run `tcpdump -w FILENAME -s 2000' or some
such.
.PP
\fBFromDump\fR sets packets' extra length annotations to any additional length
recorded in the dump.
.PP
\fBFromDump\fR is a notifier signal, active when the element is active and the dump
contains more packets.
.PP
If \fBFromDump\fR uses mmap, then a corrupt file might cause Click to crash with a
segmentation violation.
.PP

.SH "ELEMENT HANDLERS"



.IP "\fBcount\fR (read-only)" 5
Returns the number of packets output so far.
.IP "" 5
.IP "\fBreset_counts\fR (write-only)" 5
Resets "count" to 0.
.IP "" 5
.IP "\fBsampling_prob\fR (read-only)" 5
Returns the sampling probability (see the SAMPLE keyword argument).
.IP "" 5
.IP "\fBactive\fR (read/write)" 5
Value is a Boolean.
.IP "" 5
.IP "\fBencap\fR (read-only)" 5
Returns the file's encapsulation type.
.IP "" 5
.IP "\fBfilename\fR (read-only)" 5
Returns the filename supplied to \fBFromDump\fR.
.IP "" 5
.IP "\fBfilesize\fR (read-only)" 5
Returns the length of the \fBFromDump\fR file, in bytes, or "-" if that length
cannot be determined (because the file was compressed, for example).
.IP "" 5
.IP "\fBfilepos\fR (read/write)" 5
Returns or sets \fBFromDump\fR's position in the (uncompressed) file, in bytes.
.IP "" 5
.IP "\fBpacket_filepos\fR (read-only)" 5
Returns the (uncompressed) file position of the last packet emitted, in bytes.
This handler is useful for elements like 
.M AggregateIPFlows 7
that can record
statistics about portions of a trace; with packet_filepos, they can note
exactly where the relevant portion begins.
.IP "" 5
.IP "\fBextend_interval\fR (write-only)" 5
Text is a time interval. If END_TIME or one of its cousins was specified, then
writing to this handler extends END_TIME by that many seconds. Also, ACTIVE is
set to true.
.IP "" 5
.IP "\fBreset_timing\fR (write-only)" 5
Resets timing information.  Useful when TIMING is true and you skate around in
the file by writing \f(CWfilepos\fR.
.IP "" 5
.PP

.SH "SEE ALSO"
.M ToDump 7 ,
.M FromDevice.u 7 ,
.M ToDevice.u 7 ,
.M tcpdump 1 ,
.M mmap 2 ,
.M AggregateIPFlows 7 ,
.M FromTcpdump 7

